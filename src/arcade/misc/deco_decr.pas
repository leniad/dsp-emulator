unit deco_decr;

interface
uses {$IFDEF WINDOWS}windows,{$else}main_engine,{$ENDIF}
     misc_functions,sysutils;

const

     cpu102_xors:array[0..15] of word=(
		  $b52c,$2458,$139a,$c998,$ce8e,$5144,$0429,$aad4,$a331,$3645,$69a3,$ac64,$1a53,$5083,$4dea,$d237);

     cpu102_bitswaps:array[0..15,0..15] of byte=(
		( 12,8,13,11,14,10,15,9, 3,2,1,0,4,5,6,7 ), ( 10,11,14,12,15,13,8,9, 6,7,5,3,0,4,2,1 ),
		( 14,13,15,9,8,12,11,10, 7,4,1,5,6,0,3,2 ), ( 15,14,8,9,10,11,13,12, 1,2,7,3,4,6,0,5 ),
		( 10,9,13,14,15,8,12,11, 5,2,1,0,3,4,7,6 ), ( 8,9,15,14,10,11,13,12, 0,6,5,4,1,2,3,7 ),
		( 14,8,15,9,10,11,13,12, 4,5,3,0,2,7,6,1 ), ( 13,11,12,10,15,9,14,8, 6,0,7,5,1,4,3,2 ),
		( 12,11,13,10,9,8,14,15, 0,2,4,6,7,5,3,1 ), ( 15,13,9,8,10,11,12,14, 2,1,0,7,6,5,4,3 ),
		( 13,8,9,10,11,12,15,14, 6,0,1,2,3,7,4,5 ), ( 12,11,10,8,9,13,14,15, 6,5,4,0,7,1,2,3 ),
		( 12,15,8,13,9,11,14,10, 6,5,4,3,2,1,0,7 ), ( 11,12,13,14,15,8,9,10, 4,5,7,1,6,3,2,0 ),
		( 13,8,12,14,11,15,10,9, 7,6,5,4,3,2,1,0 ), ( 15,14,13,12,11,10,9,8, 0,6,7,4,3,2,1,5 ));

      xor_masks:array[0..15] of word=(
      $d556,$73cb,$2963,$4b9a,$b3bc,$bc73,$cbc9,$aeb5,
    	$1e6d,$d5b5,$e676,$5cc5,$395a,$daae,$2629,$e59e);

      swap_patterns:array[0..7,0..15] of byte=(
	( $f,$8,$9,$c,$a,$d,$b,$e, $2,$7,$4,$3,$1,$5,$6,$0 ),
	( $c,$a,$b,$9,$8,$f,$e,$d, $6,$0,$3,$5,$7,$4,$2,$1 ),
	( $8,$c,$b,$9,$d,$e,$f,$a, $4,$6,$5,$0,$3,$1,$7,$2 ),
	( $8,$9,$a,$d,$b,$f,$e,$c, $5,$4,$0,$7,$2,$6,$1,$3 ),
	( $c,$d,$e,$f,$8,$9,$a,$b, $1,$5,$0,$3,$2,$7,$6,$4 ),
	( $e,$f,$d,$8,$c,$a,$b,$9, $1,$2,$7,$6,$4,$3,$0,$5 ),
	( $d,$e,$a,$b,$9,$8,$c,$f, $3,$1,$7,$4,$5,$0,$2,$6 ),
	( $9,$8,$e,$a,$f,$b,$d,$c, $6,$0,$5,$2,$4,$1,$3,$7 ));

  deco56_xor_table:array[0..$7ff] of byte=(
	 0, 1, 2, 3, 4, 5, 5, 6, 7, 8, 9,10, 7,11,11, 9,11, 3, 7,10,12,13, 3,14, 0, 0, 9, 0,15, 3, 4,14,
	 6, 3,14,14, 3,12, 3,13, 9, 5,13, 3, 8, 2, 7,14, 2, 5, 1, 2, 3, 4,14,11, 8, 0, 6, 7,10, 3, 4, 7,
	15, 1, 2, 7, 7,14,15, 0, 7, 9,15, 3,14,10, 9,12,11,12, 2, 8, 1,10, 9,14, 5, 6,15,10, 4,15, 5, 2,
	 3, 2, 4,15, 7, 7,10,13, 1,13, 6, 6, 7, 5,10, 9, 5,15,14, 2, 7,12, 7, 4, 2,15,12,10,11,15, 4, 6,
	 9, 3,11,13, 0, 3, 6, 4,15, 8, 3, 8, 0, 3,13, 8, 6, 0,11, 4, 9, 7,11, 1, 8, 1,10, 9, 2, 8,11,15,
	 2, 8,10, 5, 3, 8, 0,10, 0,15, 3, 1,15, 3, 8, 6,13,11,10, 4,15, 4, 4, 3, 7, 7,15, 3,11,15,15, 2,
	 3, 7,13, 4,10,12, 9, 8,11, 2, 5, 8, 7, 4,14, 0,12, 1,15,10, 3,10, 5,13, 1, 4, 0, 7, 7, 2, 8,15,
	12, 1, 9,14,12, 9,11, 5,13, 1,12,12,14, 8, 8,13, 4,13, 1,12,10, 1,10,15, 7, 5, 1,13,10,10,15, 1,
	 3,14,13, 0, 0, 1, 3, 9, 5, 0, 4,13, 6,14, 2, 8, 3, 3, 5, 8, 1,10, 7, 5,13, 4, 2,12, 5, 1, 0, 4,
	 4, 6,14,10, 6, 3,11,10, 0,10, 2, 3,11,11,15,13, 3,10, 3, 8, 3, 4, 7, 1, 5, 3, 9, 8,14,13,13, 4,
	 1, 0, 1,12,12,12,11,11, 3, 7, 4,10,10, 3,10, 3, 1, 7, 4, 6, 2,12, 3, 3, 0, 0,10, 0, 6, 8, 0, 7,
	 2,15,10,14, 1,14, 4,12, 4, 2, 3, 4, 8, 0,10,10,15, 1, 8, 4,11, 2,12, 6,12,12,12, 2, 4, 6, 3,12,
	 4, 7,14,11,10, 6,13, 3, 4,14, 7, 5, 7, 5,10, 8, 5, 0, 7,12, 3, 7,14, 3, 3, 8, 0, 7, 6, 9,11,15,
	10,15, 9, 7, 0,13, 7, 3, 7, 4,10, 1, 7, 4, 3,15, 2, 6, 1,14,12,12,10,10, 1,11,15, 0,10, 7,12,15,
	 8,10, 2,14,11, 0,10,12,13,15,12,15, 8,11, 5, 3, 0, 7,10, 6, 1, 9,11, 8, 4, 2, 4,12, 6, 3,15, 3,
	 2, 1,10, 2, 2, 7,10, 6,11,12, 6, 2,11, 7,15, 1,13, 9,12, 3, 9,12, 2,12, 6, 5,11, 8, 0, 7,14,10,
	 7, 8, 6, 5,12, 4, 1,12,12,13, 8, 4, 8,12, 8, 2, 1,15,13,14, 8, 6,11, 2,13, 5, 6,10, 9, 5, 7,11,
	 5,11,13, 2, 0, 8, 2,10, 2, 1, 6, 4, 8,14, 0, 4, 8,11, 8,15,12, 0,15, 6, 1,13,15,10, 3,13,14,13,
	 4, 5,12, 4, 3, 8, 9,15,13,11, 4, 8,10, 7,12, 7, 7, 9, 7,11,13, 0,15, 5,11, 5, 6, 2, 5, 1, 9, 2,
	 9,15, 9, 8,14, 6,11, 7,10, 4,14,12, 3,12, 3, 0, 4, 8,11, 9, 5, 7,14, 1,10, 3, 2,12,12,10,12, 8,
	 4, 5,10,13,11, 6,14, 4,13,14, 8, 3,10, 5, 6, 4, 4,10, 6, 5,12,11,10, 5, 9, 6, 7, 6, 4, 6, 3,15,
	 5,14,14,13, 7, 6,12,13,15, 5,15,10, 2, 1,15, 3,10,15, 7, 4, 5, 2,10,15,14,15, 1,13,12, 9, 8,14,
	15, 3, 4, 1, 9,13,13, 3,12,15, 8,15, 7, 1,10,12,10, 9,12,10,14, 6, 5, 5, 4, 0,12,14,15, 6, 5, 5,
	 2,14, 2, 6,14, 2,12, 7, 5, 1, 2, 3, 2,12,15, 4,10, 5,10,13, 0, 2, 2, 1, 5, 7, 5, 2, 0,13, 0, 4,
	13,13, 9,12, 5, 5,10,15, 6,11, 5, 2,11, 8, 0, 6, 9,13, 2, 6, 1,11, 5, 1,12, 8, 4, 7, 9,13, 4, 4,
	15, 3, 4, 5, 5, 0, 9, 4,10, 8, 1, 0,13, 8, 6,12,15,15,10, 7,10, 2, 6, 1, 4, 0, 2, 8, 3,10, 2,12,
	 4, 1,12,15, 0, 1,10, 0,10,11, 6, 1, 0, 3, 2, 3, 4, 4, 9,14, 7, 3,13, 7,13, 9,14,12,10, 5, 4,14,
	 0, 5,15, 8,12,12, 0, 5,11,15, 8, 7,15, 5,12, 5, 5, 3, 6,13,15,15, 7, 0, 3, 9, 1, 5, 7, 7,12, 5,
	 3,12,10,11, 2,11, 5,10, 1, 3, 6, 2, 7, 1, 3, 0, 6, 8,12,15,14, 6,10,13, 9, 1,15, 4, 6,13,14, 7,
	 2,13,12, 9, 4, 7, 9, 9, 6,10, 6,15,15, 2, 0, 4,12,12,10, 2, 7, 4,14,10, 2, 6, 5,12, 0,14, 1,15,
	13, 1, 4,13, 3,13, 6,15,11,15, 0,13,12, 5, 4,11,14,15, 6,13, 6, 7, 2, 2, 7,11, 6, 7,15, 0,13,10,
	 6,14, 9,13,12,14, 4, 8, 5,13, 3,14, 6, 6,13, 8, 7, 7, 5, 8,12, 2, 6, 0, 6, 8, 2,13, 9,14, 3,15,
	 1, 4,13, 3, 6, 8,15, 4, 8, 7, 4,10, 0, 9, 2,15, 2, 1, 3, 3, 1, 4, 0, 3, 1, 8, 5, 0,10, 0, 1, 6,
	11, 3,12, 0,14,11, 0, 5,15, 9, 1, 7,15,12,12,10, 2, 2, 3,15,13,13, 2,13,14,13,13, 8,11,10, 9, 9,
	 9, 7, 7, 4, 9, 1, 9,10, 9, 9, 9,15,13,14,12,13, 6,11, 4, 6, 9,14, 6, 6, 7, 0, 8, 6,10, 7, 9,13,
	 4, 8, 1, 8, 9, 9, 3,14,10,14,11, 7,15, 8,13,11, 9, 0, 5, 4, 4, 7, 6, 0,13, 9,13, 7, 9, 3, 2, 0,
	 7,11, 5, 8, 8, 0,10, 3, 1, 4, 2,15,12, 5, 2, 6,15, 5,13, 6,12, 8,10, 9,12, 9, 1, 2,15,14, 5,11,
	13, 3, 6, 8,15, 5, 8, 2,10, 2, 8,14,15, 5, 4, 0,10, 2,14,14, 8, 8, 9, 9,11,11,12,11, 5, 4, 2,12,
	15,12, 1,11, 5,13, 0,12, 2, 4, 0, 0,12,12, 4,15, 7, 1, 2,13,10,10, 6, 4, 8, 6, 0,14,13, 1, 8, 3,
	10, 9,11,12, 6, 0,11,14, 1,13, 7, 4,11, 3,10, 0, 2,10,14,13, 7, 8,10, 7, 7,12,10,11, 3, 9,13, 8,
	 0,10,10,13, 7,12, 8, 8, 5,15,10,15, 7, 1, 8, 2,12, 1,14,10,10, 4, 5, 7,11, 3, 7, 7, 1,12,12,12,
	 1,14, 4, 0,11,15, 8,10, 1,14, 2,11, 5, 5,10,12, 2, 2, 1, 0,10, 0, 6, 2,10,13, 1,11,14, 0,12,11,
	 8, 8,12, 4, 5, 5,14,14, 9, 8, 0,10, 1, 9,15,10,13, 5, 2, 7, 1, 2, 6, 5, 5,11, 0,13, 8, 0, 7, 2,
	15,11,15, 0, 5,15, 5, 6, 0, 2, 5, 3, 0,14,14, 4,11, 7, 7, 4,10,11, 1, 8,13, 9, 4,13, 3, 6, 1,10,
	 1, 0,15,15,12,10, 6,11, 3, 4, 7, 8, 7,14, 8, 7,12,15, 9, 8, 7,14,14, 9,15, 8, 9, 4,12, 3,12,12,
	 7, 8,11, 2, 4, 8, 4, 9, 4,11,15, 2,13, 6, 3,13, 1,13, 5, 0, 2,10, 5, 8, 1,13,14, 0,11,15, 8,12,
	10, 4, 5,10, 4,11,11, 2, 2,13, 2, 6, 0, 7, 4,11, 1,12, 6,13,14, 5, 9, 0, 5,13,14, 6,13, 3,13, 9,
	14,14, 0, 9,12,14, 9,10, 1, 2,12, 3, 3,15, 8, 4, 3, 1,13,13,13,13, 4, 3, 5,15, 8, 2,15,13,11, 7,
	 4, 0,15,14, 1,13, 6, 8, 2, 8, 7,14,11, 7, 4, 1, 8,12,13,11, 0, 9, 0, 3,12,11, 2, 3, 9, 1, 3,13,
	 4, 5,15,10, 5, 9, 0, 3, 9, 6,13, 7,15,13,11,13,12, 6,14,15, 3, 6,10, 3,11,10, 1, 4,13, 0,15,15,
	11, 0, 7,14, 9,15, 1,14, 2,13, 7,12,11, 7, 9, 6,11, 5,12, 4, 3, 6, 8, 3, 9, 0,15, 7, 1,11, 7,12,
	 2,13,13, 3, 0,11, 1,11, 6, 1, 5, 5, 4, 5,12, 3, 3,15, 3,10, 7,12,15, 0,13,10, 0, 2, 6,12, 9, 5,
	 3, 0, 0, 6, 3,13, 7,14,11,15, 7, 2, 2,11, 6,11, 9, 3,10,11, 1, 8, 1,13, 0,11, 2,10, 3,12, 4,11,
	 0, 0,10,10, 2, 3,15, 0, 0, 9,14, 5,14,10,14, 0,13, 1, 1,12, 3, 3, 1,15, 8, 8,11,13, 8, 4, 8, 5,
	 8, 7,13, 2, 1, 1,14,15, 1, 7, 7, 1,14, 1, 4,14, 0, 0, 7, 6, 5,11, 5, 8, 7, 1, 4, 3, 8,14, 5,11,
	13, 8, 1, 9, 6,12, 9, 6, 3, 3,11,12, 5,11, 4, 4, 3,11, 0, 0,10,10, 7,15,15,11, 1,11,13,11, 6, 8,
	 2,15,10, 7, 0, 6, 3, 5, 2,14,12, 8,12,10,15, 8, 4,11, 8,13,11, 2, 5,13,10, 5, 9,10,15, 6, 3,12,
	 3, 0,11,15, 5,13,12,13,12, 0, 8,12,10, 0, 5, 5, 3, 2,10, 5, 3,10, 7, 2,13,12,15,13, 1,10, 4,10,
	12,14,12, 1, 6,13, 6, 6, 0,13,11, 4, 5, 7, 1, 7, 7, 0, 4,13,13,12,14, 6, 1, 3,13,11, 1, 4, 9, 9,
	 2,12, 8, 5,10,15, 2, 0,14, 9, 5, 8,11, 5, 3, 4, 7, 1, 2,13, 3, 8, 1, 3,11,12,11, 5, 1, 5,10,12,
	10, 2,10,13,12, 3, 9, 2,12,14,13, 8, 2, 1, 5, 3,15, 2, 8, 2, 1,15,10, 6,10, 3, 8, 9, 6, 9, 2,10,
	 4,12,10,15,14,15, 1,15, 0,13, 6, 0, 5, 6,13,12, 2,14, 0,10, 6,15, 8, 8, 6, 8, 2,12,11, 3, 9, 5,
	 9,15,11, 3,11,14,15, 6,14, 6, 7,12, 7,10, 6,14, 6, 6, 3, 5, 9,14, 7, 5, 8, 6, 2,12,15, 1, 2, 4,
	11, 6, 3, 0, 5,11,14,14,14, 4,13, 6,11, 6, 4,12,15, 2, 4, 1, 1, 5, 1,15, 7, 0, 5, 0, 0, 0,12, 1);

  deco56_address_table:array[0..$7ff] of word =(
	$527,$1a1,$2f6,$523,$297,$005,$141,$3b4,$539,$794,$6dd,$498,$59b,$119,$5db,$631,
	$2f1,$565,$409,$158,$2d6,$16e,$571,$0b9,$543,$52b,$668,$0c0,$5fd,$216,$5ea,$24e,
	$14b,$09b,$6d1,$2f5,$591,$0b4,$0a8,$64a,$39b,$0d9,$336,$2a1,$460,$068,$7b4,$187,
	$59a,$2f0,$5cd,$181,$7f7,$733,$223,$581,$4c5,$1d4,$11b,$22a,$688,$738,$130,$202,
	$12e,$203,$33e,$4d0,$2bd,$0c4,$042,$614,$6c2,$385,$3ed,$7e2,$2bb,$2ef,$3e1,$654,
	$73f,$447,$15f,$41d,$320,$05a,$2f4,$116,$1d6,$0c2,$4c1,$0f3,$694,$28f,$15c,$125,
	$343,$291,$33b,$21e,$031,$4fa,$76b,$133,$503,$4e8,$19c,$3c6,$24a,$0b5,$1df,$71e,
	$5ed,$564,$648,$5d7,$5c2,$4a4,$30e,$750,$474,$11f,$4a2,$3bb,$64c,$258,$4c7,$586,
	$071,$362,$593,$252,$2b0,$5aa,$053,$047,$6ef,$669,$6e8,$011,$093,$443,$33c,$060,
	$211,$7d3,$4c8,$426,$1c1,$2e8,$1fb,$51a,$402,$49f,$519,$1c7,$096,$4e6,$279,$455,
	$7ac,$3a6,$4af,$736,$1cb,$45c,$275,$18c,$776,$6e0,$5d4,$59c,$210,$358,$64f,$2cf,
	$0f4,$307,$577,$7ba,$296,$0f6,$1a3,$09d,$2c5,$532,$7bd,$26c,$171,$727,$5ba,$2da,
	$37b,$707,$366,$10e,$346,$107,$20a,$4b1,$12d,$10b,$603,$788,$2f7,$6da,$28b,$08d,
	$3ff,$1e6,$2a4,$39f,$454,$112,$2ec,$441,$0fa,$054,$3e5,$3a2,$1ec,$322,$53e,$413,
	$5b5,$058,$751,$27a,$3a7,$2d1,$16d,$3f3,$5f5,$13e,$122,$1fe,$069,$7dd,$213,$424,
	$36f,$6f5,$20e,$431,$5b2,$25e,$601,$169,$1a9,$1cd,$2e3,$39e,$338,$7e5,$5e5,$7b1,
	$3dc,$464,$065,$255,$246,$71c,$55c,$3f7,$5f6,$0c8,$1b4,$148,$284,$69f,$17f,$4cd,
	$6d4,$63f,$7ca,$28a,$75f,$2df,$708,$442,$00e,$140,$457,$14f,$63a,$420,$23e,$672,
	$440,$716,$3ca,$1bb,$622,$367,$018,$109,$3c1,$206,$7cb,$42e,$44c,$613,$61e,$67c,
	$396,$06d,$01b,$0c9,$40f,$4b6,$6b8,$485,$758,$4d3,$61b,$34d,$4fe,$7a6,$025,$3eb,
	$73a,$79b,$3db,$312,$190,$35d,$7b2,$78b,$248,$010,$075,$12b,$345,$753,$64b,$163,
	$374,$557,$4d8,$25b,$780,$479,$012,$360,$51c,$3a1,$0d0,$020,$137,$5cf,$7c5,$189,
	$679,$352,$7da,$48a,$18b,$5fc,$1fd,$344,$4dd,$69e,$761,$542,$65d,$55b,$755,$4f9,
	$427,$501,$329,$6f2,$2b4,$1b6,$319,$459,$3fb,$6df,$4ab,$176,$2fd,$62f,$1ca,$1b3,
	$1b7,$2dc,$674,$56c,$3ab,$428,$6c0,$541,$23d,$283,$6aa,$5cb,$231,$713,$014,$79c,
	$1af,$3f2,$32b,$19b,$0d2,$25c,$5be,$1c5,$383,$50d,$3e4,$657,$4bb,$0e8,$403,$26b,
	$14e,$3b7,$08f,$31b,$43f,$375,$2ca,$6bc,$678,$13d,$0e3,$395,$2ff,$120,$7eb,$630,
	$52d,$369,$36a,$58c,$538,$04a,$461,$24f,$717,$73c,$784,$59f,$0c3,$340,$476,$207,
	$6b7,$31c,$0da,$729,$2c0,$7f0,$3d5,$67a,$092,$314,$34f,$2bc,$6ee,$32a,$1a7,$06b,
	$40b,$029,$7fc,$608,$316,$15a,$113,$3b8,$22b,$445,$389,$7a1,$174,$218,$10d,$29b,
	$4a5,$0e5,$25f,$250,$75e,$4c4,$721,$230,$0d8,$3c2,$680,$65f,$25d,$222,$44d,$57d,
	$056,$37f,$4a9,$30d,$6de,$7f5,$423,$2f9,$3be,$097,$380,$27c,$5f1,$2ba,$1ea,$2a5,
	$162,$0bd,$4ff,$5fa,$3bf,$01c,$3ae,$682,$550,$46a,$13c,$193,$3cb,$01e,$6e9,$03a,
	$6d6,$323,$55a,$74f,$508,$4f1,$616,$609,$2b3,$32c,$0b7,$584,$77c,$4c2,$412,$20d,
	$21c,$5f8,$26f,$69a,$40d,$50b,$552,$000,$4e9,$6e2,$022,$5d1,$2f3,$243,$22d,$706,
	$304,$76d,$201,$1e0,$7be,$3a9,$074,$1ac,$57a,$754,$244,$08a,$425,$561,$6d3,$48f,
	$298,$636,$760,$507,$282,$013,$091,$232,$067,$1ef,$691,$7e8,$489,$62e,$289,$487,
	$3df,$562,$3e7,$104,$040,$117,$3d8,$3f1,$135,$1b2,$3cc,$0e4,$5e8,$75c,$595,$2af,
	$72f,$361,$0cf,$5ca,$3d1,$049,$002,$347,$287,$337,$799,$404,$7bc,$0f1,$101,$467,
	$1e2,$544,$095,$37c,$2fa,$763,$38f,$376,$722,$035,$2e1,$28e,$09e,$4fb,$26d,$611,
	$46c,$5e7,$563,$6d2,$724,$2a0,$475,$24d,$240,$437,$7c8,$1dc,$47a,$356,$72b,$06a,
	$765,$499,$1a8,$7b0,$73d,$592,$149,$4cb,$5a9,$1e1,$4ba,$774,$0b6,$570,$469,$294,
	$2d0,$5df,$5a3,$16c,$273,$2b9,$6c3,$68a,$5c6,$041,$768,$4e3,$0bc,$077,$21a,$2db,
	$0be,$006,$79a,$17b,$6ec,$689,$4b5,$471,$0f5,$515,$683,$47d,$576,$5de,$3b0,$705,
	$676,$7d4,$659,$02c,$49e,$05e,$02d,$68c,$3c8,$4b9,$5dd,$390,$0f0,$42a,$663,$381,
	$48b,$06e,$2be,$0c7,$42f,$62c,$568,$5ee,$212,$559,$3ec,$3b9,$180,$4e2,$1e9,$303,
	$446,$387,$6c9,$52a,$33d,$7e4,$325,$5ff,$554,$290,$675,$7db,$22f,$578,$5bf,$3b6,
	$4b7,$7dc,$5e2,$18f,$1ba,$56a,$78c,$6af,$5a2,$749,$4d6,$208,$400,$43a,$35f,$286,
	$251,$332,$030,$6f6,$0d3,$786,$3a5,$214,$087,$667,$378,$29e,$015,$166,$7ce,$1f7,
	$3e8,$49c,$787,$6be,$16f,$0ba,$7d6,$458,$488,$783,$7cf,$588,$5dc,$6c4,$70a,$100,
	$4fd,$13a,$078,$715,$1d2,$633,$32d,$72a,$6d5,$6fd,$78f,$3d2,$2c3,$03e,$17e,$505,
	$583,$326,$2ea,$51b,$44a,$04d,$3d7,$1e4,$0ab,$3e6,$124,$3b1,$368,$2c2,$6c6,$68e,
	$4ee,$1d5,$00c,$430,$71a,$651,$22e,$20f,$4ec,$08e,$292,$086,$589,$435,$6db,$567,
	$769,$4f6,$599,$038,$36d,$448,$4f7,$3fa,$082,$3c0,$021,$4bf,$5b9,$277,$023,$422,
	$0c6,$6ab,$4e5,$044,$00f,$23a,$664,$36b,$6fb,$462,$3d4,$5ec,$439,$604,$04c,$546,
	$0a2,$14c,$436,$128,$063,$735,$7cc,$410,$105,$4d1,$655,$1b5,$3a4,$6ba,$04b,$634,
	$7c6,$1ce,$3ef,$11a,$066,$433,$767,$526,$524,$37a,$5ad,$0ec,$4dc,$38d,$35b,$4b2,
	$54d,$19d,$172,$495,$692,$545,$6a8,$5a0,$164,$407,$742,$145,$1ab,$7c4,$285,$299,
	$1aa,$66b,$55d,$594,$69b,$138,$660,$463,$5b8,$027,$29d,$57c,$77a,$481,$797,$7d9,
	$732,$7c1,$6c1,$416,$701,$78e,$695,$4a6,$7ea,$44f,$7e6,$106,$5d9,$57e,$4f2,$779,
	$79f,$509,$2b5,$22c,$502,$108,$0b8,$228,$062,$147,$4fc,$417,$205,$619,$60b,$308,
	$7d7,$1ee,$555,$0bf,$398,$04e,$02e,$061,$4f3,$699,$182,$48c,$0e9,$4b8,$196,$27e,
	$1de,$2b6,$3d6,$677,$0d6,$579,$700,$19a,$3af,$68d,$51d,$5d2,$31e,$4ae,$617,$1f8,
	$47c,$7b3,$7e3,$50f,$470,$3a3,$6dc,$0c1,$46e,$6b2,$5ae,$5e1,$492,$6b6,$14d,$178,
	$1c9,$798,$781,$0a5,$23b,$702,$540,$245,$3d9,$3b5,$3ea,$6ae,$605,$3de,$0aa,$179,
	$2c9,$2ae,$0ee,$6a0,$262,$4ac,$0cc,$60a,$5b1,$0cd,$194,$0ad,$76c,$73e,$71d,$5eb,
	$7c0,$486,$0cb,$200,$551,$1c6,$3bc,$686,$696,$12c,$242,$321,$373,$60f,$635,$56d,
	$115,$5e6,$4da,$704,$48d,$261,$4f8,$217,$49a,$6fa,$085,$56b,$2ad,$75a,$5da,$720,
	$790,$1f9,$10f,$55e,$05d,$21d,$748,$263,$4d7,$771,$3bd,$26e,$07e,$415,$432,$6eb,
	$525,$2ee,$703,$08b,$274,$310,$533,$1b0,$21f,$5f3,$1b1,$090,$5a6,$35e,$7ad,$6e5,
	$330,$4b0,$175,$4c6,$70d,$2d3,$2b2,$68b,$5ef,$650,$003,$081,$1b9,$46f,$01f,$026,
	$7cd,$2cb,$642,$0a6,$764,$7a3,$58e,$45a,$63b,$6ed,$1db,$5e4,$78d,$661,$2e4,$051,
	$719,$558,$7fd,$4d2,$348,$220,$5e9,$377,$434,$5d3,$4a1,$07a,$301,$7a9,$33f,$372,
	$52e,$582,$70f,$1d9,$690,$6f4,$391,$084,$4a0,$399,$7af,$6f0,$5ac,$7f6,$1ae,$392,
	$77b,$52c,$7f9,$2e7,$0a9,$5a7,$3a0,$6a1,$5bc,$6fc,$32f,$746,$6bd,$16b,$42d,$036,
	$233,$0f7,$224,$480,$055,$465,$4aa,$159,$5fe,$478,$1c3,$536,$518,$7c2,$143,$7e1,
	$331,$597,$199,$5ab,$4d5,$2de,$0ed,$0dc,$317,$229,$4db,$76e,$351,$5c1,$618,$684,
	$54b,$1f4,$103,$553,$64e,$2b1,$271,$775,$1a5,$239,$521,$51f,$12f,$418,$466,$134,
	$468,$0f9,$15b,$192,$548,$1bc,$6b9,$6e1,$411,$653,$2c1,$5f0,$6cd,$511,$0af,$7d1,
	$5d6,$5bd,$3ad,$34e,$41a,$0fd,$4f4,$33a,$666,$146,$1dd,$30f,$5a8,$254,$69d,$44e,
	$42c,$1f1,$5fb,$37d,$3b2,$080,$7d8,$2ac,$221,$1ad,$66f,$0eb,$0e6,$649,$7fe,$2a2,
	$673,$18e,$535,$5cc,$644,$293,$65e,$1f6,$573,$150,$3da,$237,$238,$3c3,$45b,$1f2,
	$4d4,$43d,$1d0,$63d,$429,$386,$64d,$46d,$620,$7ae,$453,$2c7,$57b,$697,$6e7,$2dd,
	$5e3,$09f,$019,$41b,$6e3,$43e,$363,$0db,$62d,$341,$215,$37e,$3e9,$1da,$32e,$647,
	$21b,$406,$793,$58f,$560,$0b2,$569,$607,$2cd,$640,$38e,$38a,$388,$4c9,$652,$185,
	$219,$7bf,$7ab,$1eb,$472,$4ad,$226,$2fe,$53f,$270,$739,$313,$032,$7f3,$70c,$3e0,
	$2a9,$259,$5b7,$08c,$3c7,$6ad,$15d,$2fb,$10a,$75d,$66e,$4e4,$1fa,$68f,$643,$2b8,
	$6bf,$497,$6ff,$405,$490,$170,$50e,$073,$693,$1d8,$59d,$53c,$1e8,$711,$740,$637,
	$624,$45e,$483,$6f3,$09a,$513,$5bb,$34c,$414,$54c,$007,$757,$74a,$2a3,$355,$017,
	$72e,$379,$5a1,$4a3,$2c4,$671,$731,$572,$65c,$5d0,$034,$1be,$31f,$300,$7b8,$2d2,
	$0fe,$57f,$7fb,$6a4,$227,$260,$1c2,$052,$0ef,$5ce,$547,$510,$0f2,$6ce,$6ac,$04f,
	$2d7,$0d5,$5a5,$29a,$256,$3ac,$195,$048,$752,$6d9,$606,$2e6,$7ff,$05c,$3f6,$0d4,
	$623,$602,$5b3,$58a,$77e,$6f8,$3f5,$698,$587,$78a,$450,$7c7,$2e9,$66c,$49d,$01d,
	$2ce,$046,$1d1,$357,$628,$718,$0dd,$13b,$685,$600,$741,$072,$4eb,$646,$71f,$165,
	$05b,$63e,$043,$136,$66d,$0fc,$500,$0f8,$23f,$31a,$35a,$7bb,$45f,$710,$264,$58d,
	$2f2,$079,$656,$154,$444,$03c,$12a,$7b9,$60e,$315,$364,$3f8,$725,$575,$365,$7aa,
	$6e6,$796,$009,$008,$6a3,$2ab,$549,$47b,$2a7,$778,$730,$627,$7f2,$743,$3a8,$39c,
	$598,$67f,$1bd,$65b,$71b,$615,$6d8,$27f,$714,$13f,$7d0,$0e0,$126,$118,$2a6,$7d2,
	$4cf,$2aa,$60d,$3dd,$19f,$24c,$225,$6a7,$60c,$7ee,$6e4,$41f,$6ea,$001,$687,$6cc,
	$6f7,$514,$40c,$4de,$11c,$39a,$1e3,$53d,$327,$050,$276,$632,$11d,$183,$0c5,$3fe,
	$2a8,$00b,$30b,$4f0,$79d,$257,$3f0,$15e,$43c,$6f1,$110,$596,$2c6,$5c5,$0bb,$318,
	$77d,$306,$1cc,$267,$5b6,$161,$151,$160,$638,$7f4,$1d3,$1e7,$452,$6b1,$057,$197,
	$324,$482,$333,$712,$3ba,$1a2,$3f9,$6ca,$099,$266,$25a,$17a,$61d,$1b8,$556,$4b3,
	$6a6,$0ac,$67b,$792,$66a,$0ca,$098,$74d,$75b,$522,$629,$512,$53a,$73b,$529,$156,
	$65a,$094,$48e,$737,$123,$129,$1c0,$18a,$662,$7ec,$6cf,$438,$6cb,$14a,$4d9,$728,
	$534,$658,$06c,$70b,$184,$3fc,$46b,$791,$665,$7df,$744,$3fd,$3ee,$0e1,$394,$56e,
	$496,$30a,$7f1,$55f,$6a9,$28d,$770,$2fc,$41e,$0ff,$204,$494,$186,$1c8,$155,$2eb,
	$328,$5d5,$49b,$50c,$0e7,$76a,$235,$47e,$62a,$0fb,$3f4,$7c9,$280,$4c3,$7a4,$756,
	$0e2,$5c3,$24b,$064,$305,$3e2,$38b,$7a8,$31d,$3d3,$132,$2ed,$0b1,$61f,$02b,$342,
	$18d,$00a,$62b,$4be,$72c,$1ff,$5c7,$7de,$295,$0b3,$059,$7d5,$253,$20b,$1f5,$5f7,
	$27d,$0a3,$45d,$7f8,$1a0,$088,$43b,$1ed,$037,$6f9,$153,$747,$269,$612,$16a,$265,
	$370,$574,$504,$354,$7a7,$2b7,$2d9,$54a,$7a0,$745,$421,$734,$528,$0d1,$371,$4cc,
	$585,$07b,$477,$58b,$3cd,$278,$38c,$03b,$349,$40a,$7e7,$6b4,$6c5,$19e,$493,$4e7,
	$4a8,$382,$610,$72d,$566,$36c,$5c8,$766,$083,$34b,$789,$7ed,$0b0,$173,$139,$144,
	$28c,$4e1,$20c,$3b3,$41c,$1bf,$2e0,$1a4,$1f0,$004,$77f,$7ef,$114,$63c,$34a,$27b,
	$070,$4e0,$537,$4b4,$127,$302,$033,$47f,$5f4,$3cf,$3c4,$07f,$272,$102,$6b5,$121,
	$516,$5f9,$7b6,$076,$334,$5c0,$2e2,$339,$3e3,$6b0,$69c,$0ea,$56f,$168,$5e0,$167,
	$3c9,$639,$191,$762,$7b5,$795,$384,$772,$3ce,$76f,$02f,$23c,$773,$249,$2c8,$03d,
	$74c,$06f,$09c,$0ae,$6a2,$131,$4ea,$1fc,$309,$2d8,$3d0,$51e,$7e0,$209,$111,$234,
	$01a,$782,$2e5,$506,$35c,$7a5,$2cc,$517,$30c,$0d7,$759,$26a,$4ce,$401,$1f3,$10c,
	$449,$29f,$5b4,$79e,$6c7,$028,$530,$681,$397,$00d,$670,$2d5,$5af,$520,$0a4,$6a5,
	$0df,$723,$039,$4a7,$281,$70e,$1e5,$0de,$02a,$5c4,$777,$456,$142,$451,$785,$17d,
	$393,$491,$419,$6d0,$645,$247,$11e,$0a1,$580,$473,$3aa,$709,$17c,$6bb,$177,$52f,
	$268,$0a7,$4ca,$626,$7a2,$54e,$484,$4f5,$4bd,$5f2,$198,$4df,$1c4,$5a4,$2d4,$157,
	$4c0,$241,$531,$40e,$44b,$2f8,$0a0,$1d7,$350,$152,$67d,$6b3,$6c8,$288,$36e,$7c3,
	$621,$67e,$4ef,$7b7,$7fa,$359,$408,$6d7,$29c,$5c9,$590,$045,$3c5,$5b0,$59e,$0ce,
	$50a,$236,$1a6,$641,$54f,$61c,$05f,$61a,$74e,$74b,$016,$6fe,$311,$39d,$4ed,$353,
	$625,$4bc,$335,$42b,$5d8,$07d,$03f,$089,$7e9,$07c,$1cf,$024,$188,$53b,$2bf,$726);

  deco56_swap_table:array[0..$7ff] of byte=(
	4,0,7,2,0,0,7,2,0,1,6,3,2,2,2,2,0,5,6,3,7,0,0,5,1,1,1,7,1,0,0,0,
	2,5,6,6,2,0,4,1,5,0,1,7,4,7,0,4,6,2,1,5,3,1,2,4,6,4,2,0,4,3,3,7,
	2,7,0,6,0,5,0,2,2,6,4,0,3,5,5,7,0,4,7,5,4,5,6,3,5,5,3,6,2,0,0,4,
	2,3,7,5,6,4,7,4,3,2,0,0,0,1,5,4,0,3,7,3,1,6,4,1,2,6,7,4,1,3,0,7,
	1,7,2,6,5,6,5,1,6,7,0,3,4,6,5,0,6,2,2,6,4,6,7,3,2,3,2,4,0,0,4,5,
	6,5,0,3,0,6,0,6,0,6,7,1,3,5,0,4,5,3,7,4,3,3,5,1,2,1,6,7,1,6,7,6,
	0,5,2,4,5,1,0,6,3,3,4,1,0,1,1,6,3,4,7,0,4,1,6,5,5,2,2,3,5,3,0,6,
	6,7,4,4,7,3,3,2,0,6,3,0,4,7,7,6,1,1,1,7,1,5,3,7,6,4,6,2,2,4,1,5,
	4,6,5,3,5,5,4,2,7,4,7,4,3,3,5,7,4,0,3,0,4,3,2,2,2,5,0,3,5,7,0,7,
	2,7,7,7,2,3,3,6,4,0,3,7,2,5,1,2,1,0,5,4,3,5,5,3,6,3,4,6,2,2,1,4,
	2,5,4,3,0,4,0,3,6,4,7,1,7,2,3,7,6,2,3,3,4,1,5,7,0,0,6,7,5,2,2,7,
	1,5,7,4,6,3,0,4,4,3,6,6,5,1,1,6,6,1,1,5,1,5,1,4,1,6,5,6,2,6,6,0,
	7,7,3,4,0,3,5,7,4,5,1,6,1,7,5,6,4,6,7,0,7,6,5,2,4,6,2,5,5,3,6,6,
	5,6,2,5,1,7,6,1,3,5,1,4,6,6,6,4,6,0,4,2,5,6,5,0,4,5,1,1,2,2,1,3,
	4,7,3,3,2,0,2,7,6,3,3,3,2,6,4,5,6,4,0,0,6,5,2,5,1,6,1,5,0,2,4,0,
	0,5,6,0,5,1,7,1,5,7,6,5,7,3,2,1,2,0,4,5,7,4,3,5,0,6,1,6,1,6,2,6,
	3,5,6,3,1,1,6,6,4,0,0,7,5,3,2,4,4,3,4,3,3,2,3,3,6,0,1,6,0,7,7,7,
	6,7,5,5,7,0,6,7,4,7,3,5,4,5,0,1,1,7,0,4,1,0,0,3,2,6,2,6,4,5,4,6,
	3,3,4,4,7,4,4,5,3,3,0,0,3,5,2,5,3,4,4,0,5,2,6,5,6,3,0,5,2,3,3,2,
	5,7,0,4,1,7,0,5,7,5,3,6,1,5,2,4,3,4,7,7,5,7,7,5,5,2,5,4,7,2,5,5,
	2,0,3,3,6,4,7,1,7,5,5,0,6,3,4,3,7,7,1,0,2,2,3,0,2,0,6,5,4,0,4,5,
	6,0,3,7,5,0,3,4,0,6,7,0,2,3,6,3,5,6,3,4,6,0,1,1,2,2,1,6,6,1,6,1,
	2,6,0,6,5,4,5,5,5,4,7,3,6,6,5,6,5,5,0,6,4,2,2,4,2,7,5,7,7,0,1,5,
	5,3,4,1,6,4,3,0,1,5,0,2,0,7,4,1,6,4,5,3,4,4,4,6,5,4,7,6,5,1,6,3,
	6,6,0,1,2,2,7,6,5,1,0,2,7,4,3,6,5,5,4,5,6,5,5,0,6,7,0,5,3,0,7,0,
	6,0,3,3,4,6,0,3,5,7,4,5,0,1,1,5,3,4,3,5,2,6,6,1,1,2,7,1,2,1,5,7,
	3,2,3,6,7,5,4,7,1,7,2,1,7,0,5,5,1,2,6,5,0,6,5,6,3,0,5,3,0,5,5,1,
	0,3,0,5,1,5,6,3,2,7,4,1,0,5,6,3,7,5,1,3,0,3,1,0,0,1,1,7,4,0,7,4,
	4,5,4,7,3,7,6,6,1,1,2,5,7,6,4,1,1,5,6,7,1,1,2,7,1,3,6,4,1,3,6,3,
	5,3,5,6,2,0,4,5,3,5,1,1,0,4,2,6,6,5,3,2,5,5,1,0,4,3,5,7,6,3,4,4,
	7,1,6,2,2,2,0,3,3,4,5,1,6,2,0,5,3,0,7,3,6,3,6,7,4,0,0,3,7,4,6,1,
	1,1,6,0,0,0,7,1,2,3,5,5,2,3,0,3,7,2,5,1,3,5,4,0,4,6,2,2,0,7,7,7,
	2,5,3,4,7,7,3,2,3,5,4,1,6,7,0,7,3,7,0,6,0,2,7,6,2,6,1,6,5,0,0,0,
	2,2,2,2,5,5,5,6,5,0,4,1,1,2,2,0,3,5,5,5,6,3,5,1,3,0,1,4,1,0,0,3,
	1,5,3,1,0,5,5,6,4,5,3,0,3,3,1,4,4,4,4,2,7,7,7,0,1,6,1,1,1,7,7,5,
	6,4,7,5,3,6,6,1,1,6,7,1,4,4,7,7,6,0,6,4,6,7,6,6,3,3,1,1,3,7,3,1,
	0,4,4,3,4,2,2,4,7,1,5,1,5,0,3,4,7,3,7,4,5,3,5,4,0,2,0,7,6,0,4,0,
	6,0,7,1,3,4,7,0,0,6,7,5,7,7,2,2,0,7,2,4,7,1,6,1,1,5,5,5,2,5,3,5,
	1,1,5,0,5,4,3,2,2,0,3,1,2,2,6,7,2,7,4,1,4,5,6,0,1,0,6,4,2,1,7,2,
	2,2,4,1,3,0,3,5,7,2,1,1,3,6,2,5,5,7,4,2,7,5,5,5,1,4,4,0,7,2,0,6,
	0,6,2,5,4,7,6,2,1,2,4,5,1,2,3,5,1,6,2,3,0,0,7,5,0,1,0,5,7,7,0,7,
	2,6,0,0,3,6,1,0,4,0,5,1,5,7,4,3,1,5,7,7,6,4,7,3,3,4,6,5,0,4,7,6,
	4,1,2,4,0,4,3,1,5,6,3,1,7,0,2,4,0,2,6,0,7,0,3,3,4,5,2,2,0,6,6,0,
	3,7,7,1,5,0,2,1,5,1,1,5,2,4,5,3,1,6,4,7,6,3,4,3,5,3,6,7,7,4,4,3,
	2,4,0,6,7,4,1,6,2,6,0,2,3,5,3,0,2,2,5,5,2,3,1,5,1,0,0,0,6,3,6,3,
	3,5,6,4,0,4,2,6,3,5,1,2,7,1,3,0,3,3,0,2,3,2,7,0,7,7,4,6,2,4,7,0,
	7,5,6,7,2,2,0,2,5,0,0,3,2,7,3,3,5,7,5,4,3,6,2,2,6,4,3,7,2,6,5,7,
	7,7,6,0,2,6,7,2,4,0,1,0,3,5,3,4,3,1,7,7,5,4,0,1,6,3,0,7,6,4,5,4,
	7,3,0,5,3,5,0,6,2,3,5,0,4,2,5,3,1,1,3,7,4,1,2,7,7,4,1,6,3,7,7,7,
	6,6,4,1,1,3,1,3,4,7,5,6,2,7,2,5,1,1,6,7,0,7,6,3,4,1,4,0,1,2,6,0,
	5,2,2,2,7,7,1,7,0,0,4,5,3,3,7,5,0,4,4,4,0,5,7,0,0,6,7,7,4,1,1,6,
	1,1,0,1,4,5,2,6,0,4,4,5,7,0,3,7,4,6,6,2,1,7,6,4,7,1,7,2,5,5,6,6,
	5,5,0,5,2,0,3,4,4,7,3,7,1,2,1,2,4,0,3,3,3,4,2,3,0,1,7,0,0,0,4,0,
	7,2,1,5,6,3,4,6,2,6,6,3,5,4,3,4,0,4,7,4,7,7,0,2,1,6,7,0,6,7,5,7,
	4,0,3,4,5,4,6,7,1,7,5,3,6,7,1,7,1,0,5,5,7,3,2,6,7,4,4,2,6,7,3,4,
	1,7,4,1,5,3,3,5,3,4,6,4,4,6,0,4,2,6,0,4,3,1,7,2,7,7,1,7,1,0,4,6,
	4,7,1,7,6,3,3,3,6,0,3,6,2,3,6,2,6,4,5,3,1,2,1,6,7,5,0,0,4,0,7,0,
	6,1,1,2,2,7,6,2,5,4,4,6,3,5,4,7,3,1,4,0,0,2,4,1,4,6,3,6,0,7,2,3,
	0,7,7,1,7,0,1,2,7,3,7,2,7,5,1,3,6,2,7,2,0,1,3,5,2,3,4,4,2,4,4,3,
	4,4,0,3,7,2,6,6,6,0,0,7,1,0,1,5,0,1,7,1,4,3,7,7,6,1,0,4,3,3,1,2,
	0,5,6,3,1,2,5,6,0,0,0,4,2,0,1,6,2,4,0,1,5,4,7,1,2,2,7,7,5,3,6,3,
	3,5,4,0,5,3,0,1,5,5,4,0,5,0,1,1,3,6,4,2,3,1,5,5,7,4,0,5,7,0,6,6,
	6,6,7,3,2,2,5,4,0,6,1,1,6,0,4,3,2,0,4,0,3,4,7,3,3,5,7,1,3,5,2,3,
	6,5,6,0,1,1,6,0,6,1,7,2,4,5,6,5,0,4,0,3,2,3,7,7,0,3,5,0,4,1,1,1);

  deco74_xor_table:array[0..$7ff] of byte=(
	13,13, 0,10, 8,15,12, 0,10, 8,13,15,12, 3,15, 2,11, 1, 8,10,13, 4,10,12,11, 2, 0, 3, 0,11, 8,11,
	 5,14,11, 2, 5, 3, 8,11, 8,13,14, 4, 3,13,11,10,14, 6, 9,11,11, 8, 0,15, 2, 4, 5, 7,15, 8,13,11,
	 7, 0,12, 3,13, 3, 1, 2, 6,14,10, 3,15,11,15, 7,13,14, 4, 6, 1,10,14, 8, 4,15, 2, 8,15, 9, 3,11,
	15,11, 1,14,11, 5, 6,14, 3, 9,12,14,15,12, 6,15,12,13, 3,15, 4, 0, 8, 0, 6, 8, 0, 1, 6,10,14, 9,
	12,15, 3, 5,11, 4, 9, 6, 9,13,12, 0,12,14, 9, 9,13,10,15, 8,15, 4, 9, 3,15,15,14, 8, 9, 0,10,11,
	15,15, 1,15,10, 6,11,15, 7,11, 8,15, 2,12,15,15, 1,14,10,13, 0,14, 4, 3,12,13, 3, 5, 7, 0, 4, 1,
	 3, 5,13, 2, 0, 7, 2,13, 3, 7, 9, 2,15, 0, 2, 2, 2, 8, 6, 6,14, 2,15,11, 8, 0, 1,15, 5, 4, 2,15,
	13, 1, 1,13, 4,10,15, 3,14, 2,12, 8, 9, 8,13, 2, 0,14, 2, 9, 0, 2,12, 3, 4,15,13, 8, 4,12, 3,11,
	13,15, 5, 8, 7, 7, 7,15, 5,11,10, 4, 2, 1, 4,11,11,11, 8,10, 1,13, 5, 3, 1, 5, 8,15,10, 3,10, 9,
	 4,14, 2, 8, 6,14,14, 9, 7, 2,15, 0,15, 5,10, 3, 5,12,10, 0, 7, 2, 1,11, 4,13,10,14, 3, 1, 1, 1,
	 9,10,11, 0,14, 0, 1,11, 1, 2, 4,14, 9, 1,12,15, 0,10,11, 6,10, 4, 9, 1, 1, 5, 4, 3,15, 9,11, 0,
	 7,12,10, 9, 3,14, 4,11,11, 3, 2,10, 1,12, 4, 3,11, 1, 9, 1,15, 9, 3,11,12, 7,11, 6,15, 8, 1, 3,
	10,12,10, 4, 2,13,13,11, 3,13, 1, 2, 7,13, 6, 6, 7,14,12,15, 9, 7,15, 7,15, 6, 5,11, 5, 1,15,11,
	11, 7,14,12,12, 4,11, 3, 8, 9, 8,15,12, 8,10, 6, 0,12, 5, 9, 6, 7,10, 6, 1, 6,13, 1, 3,10, 8, 2,
	 1,13, 9, 4, 6,11, 2, 6, 2,15, 4,13, 3, 0, 7, 0, 9, 0, 6,14, 2,12,11, 0, 5,12, 7, 2, 6, 0, 2,10,
	10, 5, 1,12, 5,14,12, 1,13, 2, 6,11, 7,10, 0, 0, 7, 1, 8,10, 2, 3, 6, 4,11,10,10,13,15, 0,14,10,
	 3, 8,14,10, 0, 7, 2, 4, 4, 4, 0, 9,15, 9,14, 3, 4, 3, 5, 4, 7,15, 6,13, 7,12, 1,12,10, 1, 8,15,
	 5,15,12,13,14,14, 0, 4, 0, 0, 5, 0, 6,14, 8,14,14, 1,11, 5, 5,11, 3, 0, 2,15,11, 2, 7, 1,14,10,
	14, 3, 1, 5, 5,10, 1,10,13,13, 9, 9, 2, 1, 6, 7, 6, 7,11,15, 6, 6, 4,12, 8, 4, 3, 0, 0,15, 8, 2,
	 2,14, 1, 8,11, 7,11,10, 3,10, 6,10,14,10,14, 6, 1, 3, 5, 2, 2, 5, 5, 5, 8, 3,12,15, 6, 9,12,10,
	 4, 8,11, 6, 1, 8, 9,15,15,10, 0, 6,11, 8, 2, 9,15, 2, 2,10, 0, 5, 6, 5,11, 0, 0, 6, 0, 1,13, 6,
	 4, 4, 4, 1, 4, 0, 9,12, 2,10,13, 5,10,12,15,10,12, 3, 4, 7,10,13, 3,15,12,11, 6, 8,13, 2, 8,10,
	 3,12,13, 9,10, 4, 2,11, 1, 4, 9, 1,11, 2,14, 5, 2, 0,10,12, 0, 6, 7, 0, 2,10,15, 9, 0, 0, 8, 1,
	 0, 9, 1,14, 0,13,12,13, 9, 6,10,12,10, 0,13, 3, 7, 4,12, 0,11, 0, 0,11, 5, 0,14,15,11, 8, 2, 5,
	 4, 6, 5, 9,13, 5, 4, 4,13, 4, 0,12,10, 3, 2, 2, 0,13,11,12, 4,12, 9, 7,13,14,14, 8, 5, 0,13, 0,
	 1, 4,15,15, 9, 8, 5,12,13, 8,12, 8, 8,10, 0,15, 8,11, 5, 6, 9, 8,10,12, 9,12, 5,14, 6, 9, 7,15,
	 1, 9,15, 0, 1, 9, 1, 2, 8, 1, 4,12, 1, 4, 9, 7, 2,10, 8, 1,13, 6, 0,12, 0, 6,12,13, 5, 9, 4,12,
	 7,14,10, 4, 6, 8,12, 4, 9, 1, 2, 2, 3,13,10, 2,15, 7, 1, 6, 0,12, 5,10, 9, 1, 0,14,15, 3, 7, 6,
	 9,12,13, 7, 0,13, 2, 5, 7,13, 1, 3, 8,15, 9,10, 3, 0,15, 2,11, 5, 7, 3,10, 7, 4, 0, 7, 2,10, 2,
	 0, 3, 6, 6,13, 0, 5, 9,13, 8,11, 9, 0, 4, 1,11,15, 5,15, 3, 1,15, 1,15,12, 8, 9, 4, 1, 5, 8,11,
	 5, 7, 6,11, 5, 7,15,15, 9, 4, 7,12,14,11, 8, 6, 7, 7,12, 3, 9,12, 6, 9, 5, 8,13,14, 6,14, 4, 7,
	12,12, 2,14,10, 2, 1,10, 3, 8,12,11,12, 7,12,15, 7,13, 9,15, 6, 3, 1,14,13,14, 8,11,14, 4, 9, 2,
	13,13, 0, 2, 9,11, 3, 2, 4,11, 6, 8, 2,14, 7,15, 8, 8, 9, 5, 4,15,11, 7,13, 7, 4,15,15, 4, 2, 1,
	 6, 4, 3,15, 0,11,14,15, 6,15,11,14,10, 4, 4, 0, 5, 4, 6,15, 8,10,15, 1, 3, 8,13, 3, 3, 0, 7, 7,
	 2, 3, 2,11,14, 1,12,13,10, 2, 4,13, 4,13, 9, 3, 2, 1,14, 9, 8,11,15, 4, 8, 9,13, 2,10,14, 2, 4,
	 8,13,13,14,12, 1, 5,15,13, 3,12, 8,11,12,12, 1, 0,15, 9, 2, 6, 9, 3,12, 5, 0,10, 8, 5, 6,11,14,
	 7, 7, 0,10, 0,14,10, 8, 4,12, 5, 3,11,10, 5,13,15, 9,14,12,12, 0,14, 3, 2,12, 9,14,11,11, 9, 2,
	 8, 9,13, 0,10, 3,14,14,13, 6, 4,14, 2,10,10, 9,10, 4, 5, 4, 5, 3, 4, 6,15, 5,14, 2, 6,10, 4, 8,
	 6, 9, 9, 7, 3, 3, 9, 5, 9, 8,10, 5, 0,13, 7, 8, 4, 1, 3,13, 4, 1, 8,10, 3,11,13, 3,12, 0, 2, 0,
	 3, 1, 3, 3, 1, 6,13, 2, 3,13,11, 5, 9, 0, 4,12, 6,11, 4, 4, 3, 3,12, 7,13, 2,15,12, 1,11,15, 7,
	10, 0, 9, 3, 3,13,12,12, 9,14, 2, 2, 0, 3,12, 2, 0,15, 0,10, 1, 9, 8, 3, 2, 3, 9, 1, 4, 5,12, 9,
	10,11, 0, 2, 2,11, 5,13, 8, 1, 7, 8, 4,12,11, 1, 2,11, 7, 7, 8, 6, 5, 8, 8,14, 2, 6,10, 6, 1, 9,
	 3, 4, 2, 9,11, 1, 4, 9, 8,13, 5, 0,15,13, 0, 9, 9,11, 5,11, 6, 4, 6, 9, 5, 1,13, 8, 8, 2,14,14,
	 2, 3,14,12, 4, 6,15, 4,11,14, 7, 2, 3,14, 4,15, 4, 1, 8,13, 5, 5, 7, 0, 6,14, 0, 1, 1,13, 5,10,
	10,14,14,10, 2, 9, 1,11, 5, 6, 8,12, 4, 2, 7, 7,11, 6,13,15, 1, 3, 9, 0,14,12, 9, 2, 3, 2, 1, 9,
	12, 7, 4,12,14, 3, 3, 2, 3,14,10, 5, 8, 4, 9, 9,11,14,13,15,14, 7, 3,13, 0, 9, 4, 9,12,12, 1, 2,
	10,11, 7,11, 1, 9, 2, 8, 1, 4, 5,14, 8,15, 9, 3, 8, 9, 6, 3, 7, 3, 1,10, 7, 5,13,14, 8, 7, 4,10,
	14, 4, 6, 9, 6, 2, 5, 3, 8, 0, 9, 7, 2, 7,12, 8,12, 2,15, 4, 5, 0,11, 8,11, 2,14, 8,15, 0, 8, 9,
	14, 5, 4,13,12,11, 2, 6,11, 9, 9, 7,14, 6, 6, 7, 4, 6, 3, 5,12, 5,11, 1,12,14, 0,13,15,13, 2, 2,
	 1, 8, 3,11, 3, 1, 6, 9,12,12, 5,10, 7,13,15, 4,12,10, 9,11,12,14,12,11,15, 2, 3, 2, 7, 8,15, 2,
	 2, 0,12,12, 9,11,13,14,13, 7, 3,11,11,14,12, 3, 2, 7, 4, 8, 9,11, 8,11, 5,10, 3, 7,15,11,12,15,
	10, 8, 5,13, 8, 3, 9, 8, 5, 7, 1,15,15, 0,13, 7, 8, 6, 8,10, 8, 6, 6, 3, 4,10,13, 1, 6, 6,10, 1,
	 2,11, 4,15,15, 3, 1, 1,14,12, 1,15, 1, 6, 8,10,14,14, 9, 4, 7, 8, 6, 5, 3, 1, 0, 5, 3, 8, 6, 1,
	 4, 2,13,15,14, 5,13,11,10,13,11,11, 6,10, 7, 2, 1,15, 2,10, 5, 0,11, 5,15, 8, 0,14, 3,12,11, 7,
	10, 1, 4, 0, 3,15, 7,15,12, 8, 9, 0, 1,15,13, 2, 3, 2,15,15,14,14, 7, 8,12,11,15,15,14, 2, 8, 8,
	 2, 0,15, 4, 2, 5,14,10, 4,12, 2, 1, 0,13, 7, 5, 4, 3,11, 6, 0, 2, 6,14, 9,14,10,13, 6,10, 5, 8,
	15, 2, 4, 7, 1, 8, 5, 3,11, 5,12, 1, 3, 1,14, 4, 8,12, 6,10,14, 7,14, 7,15,14, 5,10, 6, 9, 3, 6,
	12,15, 1,12, 0, 6, 1, 4,13,13, 7, 1, 7, 1, 9, 1, 8, 6, 9, 9, 8,12, 5, 2, 8,11, 9, 1, 3, 9, 0,11,
	14, 8, 5, 9, 7, 7,14, 4, 6, 1, 6,11, 4, 0,15, 5, 9, 8, 5,13, 2, 6,13,10,12, 3, 4, 3,15, 5, 6,14,
	 2,10,14, 1, 5, 9, 6, 1, 9, 2, 7,11,14, 7,14, 5, 8, 9,14,13,14, 8, 3, 8, 4,10, 3,14, 0,13,12,15,
	 9, 9, 0, 4, 6, 7,12,13,12, 1,15, 2,13,13, 8,10,13, 5,12, 5, 4, 0, 2, 1,13,12, 2,14, 9,15,13, 9,
	 7,13, 7, 0,14, 7,12,15, 3,11, 0, 5, 8, 1, 0,12, 9, 0,11,13, 6, 3, 3, 7, 2, 2, 3, 5,14,14, 0, 9,
	 2, 6, 4,12, 2, 6, 3,12, 3,13, 3,14, 7, 1, 8,15,14, 3, 0,10, 2,15,15, 9,14,11,10,12,13,13,13, 9,
	 7, 7,12, 5, 3,14, 1, 5, 1,10, 6, 7, 9, 8,15, 7,13,11, 4, 5, 4,10,14,14,12, 1,13,14,15,14,15,10);

  deco74_address_table:array[0..$7ff] of word=(
	$526,$684,$15f,$1ad,$736,$341,$4c3,$23c,$3eb,$01f,$18e,$375,$029,$227,$707,$506,
	$5ce,$0dc,$5dc,$5fd,$15c,$013,$7b9,$3c1,$77d,$1eb,$53d,$4a9,$66e,$0a9,$4e2,$361,
	$32d,$151,$16a,$5ed,$4b0,$78a,$0d1,$01e,$4be,$7dd,$22d,$125,$401,$118,$051,$784,
	$48a,$083,$42f,$56b,$448,$679,$019,$076,$44c,$663,$3a1,$740,$095,$242,$4c5,$13b,
	$3c4,$130,$122,$047,$16b,$162,$0d9,$1f4,$0be,$018,$56c,$494,$0b0,$185,$3b3,$257,
	$764,$05d,$7d4,$2bd,$159,$2fb,$07a,$365,$4fd,$451,$452,$52d,$753,$5c8,$1a4,$50e,
	$5ff,$536,$45b,$281,$4b8,$1ff,$228,$5f9,$1ca,$587,$0fd,$02a,$0da,$03f,$6a4,$671,
	$2d9,$377,$39c,$534,$6c5,$1b2,$1db,$263,$5c3,$0c7,$474,$4db,$152,$3de,$47d,$64a,
	$41c,$66c,$3d9,$769,$0c1,$4ec,$46b,$274,$6aa,$623,$31a,$2ef,$270,$1e7,$4e5,$2e3,
	$1f9,$203,$150,$4a3,$7d3,$0af,$1c8,$310,$4cd,$1a6,$14e,$636,$3f8,$04d,$337,$441,
	$3c0,$1d8,$482,$399,$3ef,$520,$260,$352,$4f8,$521,$271,$6e6,$5da,$763,$595,$4e0,
	$2db,$3c6,$012,$09b,$14f,$26b,$512,$0cb,$616,$605,$63a,$5e2,$139,$7cd,$7d0,$00c,
	$198,$234,$4f7,$37e,$0a1,$4bd,$1a1,$2f0,$3b4,$0a6,$1c7,$51e,$166,$567,$719,$5cb,
	$3b5,$31c,$751,$6a1,$065,$4fa,$6e1,$106,$1a5,$331,$3a2,$16d,$756,$090,$554,$241,
	$19a,$35c,$0e9,$388,$1c9,$11b,$5c7,$56a,$168,$5b2,$47f,$5a9,$551,$3bb,$3d3,$428,
	$132,$4d7,$1d1,$538,$5d7,$297,$6df,$0ce,$728,$2c5,$6f6,$60d,$2a0,$45f,$46d,$4f0,
	$5ea,$1e0,$4d6,$442,$32f,$243,$30f,$0c9,$344,$42d,$22f,$327,$2b2,$158,$7af,$3d2,
	$127,$6d3,$411,$7eb,$632,$277,$60b,$356,$307,$1c3,$0f1,$762,$207,$13e,$25a,$6d0,
	$38e,$0a7,$79a,$2a5,$771,$39e,$325,$160,$014,$115,$698,$712,$2c8,$3c3,$1bc,$696,
	$0d6,$692,$49f,$4de,$5b3,$0cc,$2f3,$667,$318,$52c,$3e0,$181,$462,$1f7,$366,$4f4,
	$547,$44e,$1be,$3ed,$04e,$490,$661,$703,$320,$42e,$406,$161,$259,$702,$58b,$619,
	$51f,$502,$391,$4ce,$779,$0f9,$05b,$45e,$14a,$66a,$42b,$35a,$363,$1b8,$373,$117,
	$78f,$34e,$2e0,$2d7,$7ee,$27b,$2c6,$103,$7dc,$23d,$2ad,$049,$68a,$41f,$582,$3d5,
	$631,$107,$2be,$28e,$5af,$119,$694,$744,$546,$19b,$766,$5cf,$2ee,$0e0,$4a5,$313,
	$6a3,$3b1,$28a,$104,$415,$19e,$01c,$009,$167,$266,$397,$056,$525,$416,$64f,$689,
	$706,$413,$004,$6c9,$244,$2f8,$78b,$510,$02e,$505,$5a6,$612,$114,$4d9,$1cc,$20f,
	$7e9,$13a,$584,$495,$6d2,$5f4,$093,$43f,$0e3,$382,$746,$71e,$794,$72d,$3ec,$7c1,
	$03a,$33d,$1ec,$128,$27f,$700,$149,$10c,$553,$2bc,$492,$080,$5b0,$015,$1c4,$691,
	$037,$59f,$542,$4cf,$253,$5ae,$74d,$407,$6e8,$354,$7b4,$49b,$300,$6f2,$26e,$3f4,
	$086,$37c,$1ee,$347,$6b1,$26d,$105,$55d,$1ba,$70b,$236,$3e3,$0b6,$2c2,$33b,$254,
	$140,$2e8,$5c2,$03b,$04c,$5aa,$480,$560,$6ed,$633,$7a6,$29f,$789,$0e4,$08a,$15b,
	$57e,$4fe,$532,$25c,$215,$709,$5f7,$197,$586,$2f1,$5e0,$477,$61b,$608,$063,$01b,
	$212,$016,$795,$205,$1fa,$742,$777,$40b,$146,$73b,$503,$792,$10e,$545,$7f6,$3f7,
	$4ad,$38d,$3b9,$516,$2ac,$3bd,$31b,$214,$170,$5d6,$21b,$1b1,$3cd,$213,$565,$40a,
	$113,$515,$724,$03d,$5c0,$334,$3e9,$2a8,$1c5,$089,$24e,$7cb,$4d5,$280,$36c,$2b0,
	$430,$0e6,$0d5,$3c5,$662,$275,$60f,$0de,$248,$07b,$22c,$7b5,$340,$739,$2b8,$65a,
	$508,$116,$079,$7a0,$4c2,$099,$4bb,$52a,$4d1,$389,$3a3,$1e6,$2a4,$10d,$4ba,$581,
	$0b2,$302,$0f4,$760,$25d,$4c6,$39b,$12b,$046,$637,$38b,$0f6,$109,$51c,$40d,$6e9,
	$6e2,$7da,$4a0,$487,$67e,$65f,$265,$439,$189,$208,$4b5,$250,$4f1,$16e,$496,$3fc,
	$272,$20c,$7ae,$292,$5e3,$472,$458,$66d,$657,$722,$438,$3b8,$4e4,$39a,$598,$539,
	$4b4,$290,$18b,$1de,$65c,$2ea,$6ff,$20a,$232,$058,$2d3,$0d3,$1f1,$61d,$0d2,$1d2,
	$295,$466,$038,$0ac,$4c7,$6c7,$672,$040,$6a0,$699,$624,$71f,$120,$10b,$072,$192,
	$3ba,$638,$58d,$530,$00e,$761,$6dd,$1cd,$18d,$142,$2eb,$55e,$7b2,$367,$5d3,$71c,
	$2d2,$0a0,$6b2,$134,$286,$12e,$0cf,$5dd,$2e7,$74b,$261,$082,$726,$14d,$1e3,$4b7,
	$7e7,$435,$294,$31f,$154,$2cf,$5f5,$330,$400,$13d,$629,$7d1,$4a2,$3e6,$3e8,$1f5,
	$3f3,$368,$410,$3ca,$221,$71b,$669,$195,$7f2,$70f,$006,$504,$062,$461,$053,$6f7,
	$0a3,$6fa,$1f2,$745,$7df,$12a,$05a,$23b,$4da,$568,$665,$30d,$5f6,$328,$283,$169,
	$17c,$601,$201,$6c3,$6c0,$491,$63f,$6f5,$2b5,$2c7,$628,$3f9,$02b,$38a,$2e9,$60c,
	$2a9,$102,$39f,$0c3,$42c,$7cf,$3df,$4f9,$235,$3a8,$7e4,$485,$21d,$349,$0e8,$0b8,
	$345,$683,$18c,$317,$6ca,$323,$17d,$36a,$7c9,$1a0,$3e1,$6f9,$0a2,$353,$7b6,$759,
	$287,$7d7,$25e,$523,$092,$427,$5a7,$396,$136,$75a,$3d6,$507,$385,$5de,$55f,$0ad,
	$096,$239,$5b8,$6cb,$574,$511,$41e,$537,$074,$148,$7a4,$70e,$2cb,$284,$191,$06e,
	$2da,$51a,$374,$6ba,$41b,$552,$460,$371,$183,$0b3,$444,$748,$7f4,$59e,$5bd,$381,
	$0ab,$6fd,$4cc,$3e5,$5c5,$09c,$717,$22e,$708,$1bb,$70c,$4a6,$778,$034,$1d5,$30b,
	$7f5,$743,$6ae,$2de,$2a6,$613,$5d0,$40c,$0bf,$209,$1b7,$4f5,$72b,$620,$647,$643,
	$024,$2ca,$0bd,$501,$0a4,$453,$3ff,$6b5,$625,$2f7,$556,$469,$409,$747,$031,$1f6,
	$47c,$2ab,$1fd,$533,$74f,$395,$754,$0d0,$6b0,$42a,$635,$1af,$6a9,$49c,$77b,$611,
	$2ae,$2b4,$3a5,$1b5,$3fe,$3ab,$479,$498,$3aa,$5c1,$27e,$26a,$590,$29d,$02c,$121,
	$404,$61c,$650,$518,$33a,$768,$0f2,$0b4,$686,$67b,$301,$04b,$1c1,$7d9,$772,$0c8,
	$49a,$68f,$59b,$419,$73a,$750,$360,$58e,$264,$52e,$00d,$46e,$085,$46f,$788,$164,
	$3d8,$6db,$52b,$473,$332,$073,$440,$028,$35b,$3f1,$14b,$7fb,$03e,$28c,$1ea,$3f5,
	$6a8,$53c,$5b5,$0fb,$585,$478,$179,$4ac,$137,$173,$1e5,$7c6,$262,$027,$6d8,$144,
	$3e4,$673,$7b7,$145,$6b7,$596,$1c6,$54b,$110,$155,$64e,$4f6,$44b,$7fa,$422,$5a4,
	$06c,$51d,$023,$0aa,$459,$5fc,$11a,$2dd,$4e1,$603,$224,$497,$308,$5c9,$3dd,$4e8,
	$48d,$4cb,$548,$36f,$094,$36e,$58a,$299,$797,$57d,$7c8,$75f,$321,$431,$045,$131,
	$543,$486,$1ce,$47b,$57f,$38f,$775,$1dd,$34a,$177,$4d8,$634,$48c,$2e5,$5ee,$255,
	$644,$456,$653,$1e9,$0ca,$72e,$576,$710,$6ab,$4aa,$4fb,$569,$541,$309,$1d9,$714,
	$35d,$757,$278,$7ef,$2ec,$668,$6d7,$335,$62d,$3b6,$5b4,$676,$46c,$0e2,$5bc,$7bd,
	$07f,$267,$68e,$649,$721,$53f,$226,$0cd,$6c2,$312,$1b9,$11d,$53e,$602,$6bd,$561,
	$19c,$62a,$135,$651,$09e,$3c8,$237,$204,$610,$798,$690,$5a5,$5f3,$0f8,$540,$614,
	$14c,$5d1,$00f,$402,$4b9,$583,$5c6,$21e,$457,$3f6,$07e,$216,$4b1,$369,$06b,$37f,
	$091,$580,$61a,$1cf,$4b2,$2c4,$1bf,$38c,$0ff,$314,$7d8,$26f,$7a9,$31e,$2f2,$7ca,
	$12d,$101,$54e,$32e,$791,$4a1,$76d,$6b9,$34d,$061,$69c,$6bb,$41d,$571,$711,$339,
	$5bb,$1e1,$680,$026,$032,$23f,$524,$329,$488,$2c9,$7f8,$043,$0dd,$5c4,$589,$6f1,
	$4c8,$00b,$782,$670,$6b8,$196,$1d4,$43d,$10f,$56e,$030,$165,$559,$6b6,$4ef,$67d,
	$15d,$56f,$2ed,$7a2,$04a,$4c1,$7a3,$2e4,$111,$5f8,$725,$685,$3bc,$1fb,$5a3,$178,
	$293,$3a6,$3a9,$036,$7ab,$07d,$4c9,$5a1,$5b7,$19d,$13c,$519,$0ee,$157,$5a8,$23e,
	$2af,$62e,$25b,$785,$73d,$172,$3be,$7ed,$4e6,$15e,$5e7,$211,$44d,$682,$7db,$5b6,
	$40f,$020,$0f5,$7c0,$609,$5f2,$6cf,$08b,$256,$514,$799,$5d2,$1e2,$727,$7e5,$279,
	$30c,$11c,$30a,$58f,$0df,$03c,$577,$5ef,$7c2,$55a,$5b1,$776,$65d,$2aa,$225,$3db,
	$276,$6a5,$5ec,$229,$5ca,$513,$1a8,$30e,$783,$3fd,$124,$535,$13f,$64c,$1a3,$607,
	$02f,$0e5,$701,$24c,$45c,$566,$6d1,$035,$044,$455,$042,$20e,$7e8,$767,$2fa,$476,
	$003,$2bf,$37a,$5d4,$247,$660,$1f0,$2d6,$36d,$564,$3c2,$37b,$2f4,$17a,$4a7,$176,
	$3d4,$59a,$383,$258,$08e,$098,$528,$62c,$72f,$35e,$0b5,$56d,$6f0,$44a,$723,$45d,
	$4eb,$055,$285,$0ed,$182,$429,$393,$470,$555,$3a4,$078,$1a2,$43a,$16c,$65e,$087,
	$7f3,$74e,$273,$386,$6da,$550,$25f,$206,$039,$2a3,$2e6,$199,$1cb,$445,$4c0,$06a,
	$54c,$316,$0d8,$741,$194,$05c,$606,$43e,$100,$21a,$43c,$4c4,$693,$5e1,$1d3,$240,
	$20d,$433,$796,$238,$765,$4af,$0eb,$7e1,$050,$4ee,$2d5,$75e,$5a2,$5be,$70a,$3cf,
	$376,$005,$61e,$002,$5cd,$069,$0c6,$041,$084,$64b,$60e,$268,$51b,$000,$464,$34b,
	$615,$3d7,$5cc,$1b0,$233,$7fe,$641,$53a,$24d,$00a,$32a,$18f,$282,$749,$3dc,$0b7,
	$5b9,$336,$0c4,$5eb,$398,$475,$2d8,$5bf,$646,$418,$5a0,$3cc,$531,$187,$3ea,$6bc,
	$1ab,$1e4,$69d,$63c,$6f8,$0f3,$251,$2dc,$648,$6a7,$219,$731,$573,$7f1,$070,$188,
	$7d5,$436,$730,$6de,$27d,$163,$129,$403,$298,$2b9,$06d,$357,$249,$4b3,$296,$2b6,
	$6b4,$697,$770,$484,$303,$7fc,$1da,$2d1,$7f0,$379,$16f,$222,$48f,$394,$64d,$68d,
	$3b2,$5ab,$3e2,$5f1,$7ff,$69b,$50c,$384,$655,$346,$446,$7ea,$4f3,$2fc,$2b1,$562,
	$387,$2ff,$4ed,$5e5,$5d9,$6fe,$1ef,$656,$47e,$171,$067,$600,$6eb,$246,$4d2,$73c,
	$305,$1d0,$434,$5d8,$6e7,$781,$32c,$2bb,$4d4,$4b6,$493,$0c0,$3bf,$4f2,$7ba,$774,
	$6ad,$378,$7c4,$63b,$733,$752,$454,$184,$74c,$3c9,$618,$688,$054,$414,$6c4,$07c,
	$2b7,$3c7,$2fe,$73e,$351,$4a4,$3fa,$6e4,$6d9,$4a8,$1fe,$517,$010,$4d3,$6c8,$153,
	$180,$593,$7b1,$7a5,$24b,$141,$424,$7e0,$186,$405,$2ce,$604,$425,$447,$677,$79b,
	$76f,$0ec,$2cd,$358,$1fc,$3b7,$0f0,$32b,$2cc,$138,$735,$09a,$549,$704,$720,$786,
	$3f2,$088,$639,$133,$7b0,$4ae,$2f9,$007,$54d,$68c,$509,$08d,$67a,$443,$0ba,$499,
	$06f,$71d,$0bc,$695,$3b0,$63e,$734,$057,$033,$7a1,$068,$355,$49d,$5ba,$76c,$675,
	$54a,$10a,$417,$3a0,$658,$1df,$7aa,$112,$6c1,$372,$420,$048,$011,$2df,$202,$622,
	$483,$5e6,$28d,$0a8,$324,$380,$6ea,$449,$23a,$6a2,$066,$021,$6fb,$1e8,$48b,$0d4,
	$666,$33f,$077,$50f,$370,$338,$76a,$2fd,$1d6,$2a2,$77e,$489,$3ad,$73f,$7c5,$17b,
	$471,$5df,$1aa,$2f5,$0db,$7d6,$6e0,$7cc,$645,$729,$08c,$097,$790,$41a,$4dc,$7a8,
	$1bd,$21f,$01a,$3ac,$713,$193,$55b,$59d,$1c0,$6ce,$364,$33c,$4e9,$57b,$426,$1a7,
	$21c,$1ed,$343,$69a,$732,$6ef,$55c,$72a,$18a,$7f9,$432,$29b,$7b3,$468,$319,$0fe,
	$245,$7ec,$7be,$24f,$008,$500,$31d,$33e,$217,$6be,$50d,$230,$02d,$15a,$46a,$1ac,
	$220,$0ae,$1d7,$50a,$558,$718,$40e,$621,$594,$52f,$27a,$758,$29e,$4d0,$642,$75b,
	$156,$20b,$350,$39d,$0bb,$08f,$218,$075,$652,$57c,$6d5,$0ea,$678,$052,$5db,$1b4,
	$423,$3a7,$4df,$50b,$77f,$49e,$0c5,$5ac,$79e,$3fb,$591,$5fa,$0c2,$0e1,$755,$67c,
	$66b,$60a,$66f,$481,$467,$7a7,$61f,$57a,$17e,$05f,$5f0,$7f7,$0d7,$773,$05e,$7e2,
	$6e5,$659,$4e7,$738,$24a,$12c,$77c,$4bf,$45a,$69f,$7fd,$69e,$529,$19f,$2ba,$0b1,
	$627,$412,$65b,$2f6,$269,$342,$2b3,$291,$0fc,$3da,$12f,$4e3,$592,$0fa,$463,$7bc,
	$780,$11f,$4ff,$7ac,$28f,$175,$0ef,$6d6,$4ea,$527,$3ee,$0f7,$0b9,$311,$27c,$025,
	$2c3,$71a,$6af,$190,$11e,$588,$78e,$6c6,$147,$3ae,$578,$6ac,$4fc,$252,$7c7,$43b,
	$557,$7e3,$2d0,$63d,$79c,$62b,$640,$123,$6e3,$306,$77a,$4ab,$787,$421,$1dc,$390,
	$1ae,$1f3,$705,$7d2,$081,$2e1,$5e9,$5fe,$687,$2a1,$59c,$0a5,$223,$78d,$35f,$7c3,
	$326,$575,$348,$715,$6b3,$793,$6f4,$7b8,$064,$210,$2c0,$579,$022,$3af,$74a,$200,
	$1a9,$75d,$7ce,$72c,$79f,$75c,$09d,$4dd,$2e2,$7e6,$17f,$716,$570,$7de,$017,$76e,
	$54f,$362,$29a,$522,$1b3,$22a,$572,$3d1,$408,$437,$3cb,$6dc,$58c,$6a6,$37d,$53b,
	$1b6,$7bf,$5e8,$143,$289,$392,$22b,$5fb,$5ad,$01d,$2c1,$26c,$76b,$70d,$44f,$6fc,
	$79d,$4ca,$450,$34f,$3e7,$1c2,$664,$3d0,$001,$7ad,$6f3,$359,$544,$67f,$563,$6d4,
	$108,$48e,$3f0,$04f,$322,$6cd,$2d4,$597,$09f,$62f,$5e4,$28b,$681,$231,$630,$315,
	$68b,$059,$3ce,$36b,$654,$47a,$29c,$6bf,$071,$6cc,$2a7,$333,$304,$1f8,$0e7,$599,
	$174,$060,$674,$6ec,$7bb,$288,$6ee,$737,$34c,$617,$4bc,$5d5,$78c,$465,$126,$626);

  deco74_swap_table:array[0..$7ff] of byte=(
	2,7,5,7,1,1,4,4,7,5,6,7,7,3,4,3,0,2,1,3,0,4,7,7,2,5,3,1,4,4,6,7,
	6,7,4,5,1,3,0,3,7,2,5,0,1,5,2,1,4,0,6,1,1,2,4,2,1,0,6,5,2,6,4,6,
	4,4,2,2,0,6,0,4,6,0,1,7,0,6,1,2,5,0,1,5,0,2,6,2,2,7,0,7,2,4,6,3,
	3,5,1,1,2,3,4,1,4,6,1,4,0,6,6,3,5,4,1,1,3,0,5,7,5,4,5,4,3,6,2,0,
	4,5,7,3,1,3,4,7,7,4,2,7,1,6,4,1,1,4,0,4,2,0,4,0,1,5,6,4,7,7,3,7,
	7,0,1,2,6,7,7,0,5,1,2,4,2,0,4,4,7,4,0,3,7,1,7,4,2,5,7,4,3,7,3,6,
	7,3,0,5,1,7,5,3,0,1,6,1,7,4,7,6,5,1,2,7,3,3,1,4,6,2,3,7,0,4,5,6,
	3,2,3,1,7,6,0,1,5,7,4,0,5,1,4,1,2,0,6,4,3,5,7,4,3,0,0,6,5,1,7,6,
	0,2,4,0,0,5,4,7,4,3,3,0,2,3,5,7,0,3,2,3,7,2,0,0,7,6,3,5,0,1,3,2,
	4,7,2,3,4,7,1,5,6,7,3,6,4,1,7,7,4,4,3,4,0,7,5,3,2,5,7,7,0,4,0,7,
	7,2,5,1,2,4,7,6,0,6,7,0,5,0,1,6,5,0,2,4,5,1,6,7,6,0,7,0,6,0,1,4,
	3,2,0,2,4,6,3,2,3,3,0,5,7,2,3,7,1,2,6,3,7,2,0,5,7,1,2,6,4,3,4,6,
	4,0,1,4,2,3,3,2,3,7,0,7,4,3,2,1,0,3,5,2,5,3,0,0,0,4,6,4,4,6,1,0,
	3,1,1,5,7,1,5,2,0,1,5,7,2,4,5,4,2,6,3,1,4,0,3,0,1,7,3,5,1,1,1,2,
	2,3,4,1,2,0,0,7,1,6,1,5,2,2,2,1,6,6,0,5,5,4,2,3,7,4,6,6,6,3,1,3,
	3,0,1,7,4,6,3,7,0,1,4,2,3,3,1,7,6,0,6,4,1,3,6,1,6,2,3,1,6,5,3,4,
	2,1,3,3,1,6,6,3,6,6,5,0,1,7,1,0,4,6,0,6,0,0,3,6,5,6,4,0,4,2,6,5,
	0,4,2,7,6,2,4,6,6,4,6,6,0,5,6,6,5,2,3,0,4,4,6,4,1,6,6,0,7,0,1,6,
	1,2,2,4,6,4,2,5,4,2,2,5,4,1,3,3,4,5,3,4,5,6,3,5,2,3,7,6,1,0,4,4,
	7,6,0,5,2,6,2,2,3,7,1,5,4,2,6,7,0,5,5,2,5,7,5,6,2,3,0,5,4,5,2,1,
	0,5,3,6,7,2,3,4,0,3,5,7,6,6,5,6,7,2,2,2,3,5,0,2,0,1,2,2,4,6,7,2,
	5,4,4,3,5,7,3,4,5,3,4,7,1,2,3,5,3,3,6,0,4,4,2,5,4,1,7,2,7,7,4,5,
	2,1,0,3,4,1,3,6,2,4,3,3,3,0,0,1,2,0,3,3,6,5,6,7,5,2,0,4,2,0,1,6,
	7,1,0,4,1,7,5,2,3,0,2,7,2,2,4,6,7,5,7,5,0,6,5,3,2,7,2,3,3,6,0,4,
	1,5,2,2,5,6,4,1,3,6,2,7,4,3,4,1,6,0,5,6,0,0,3,1,1,2,4,3,4,1,4,2,
	0,3,0,7,6,3,2,0,2,3,6,5,3,3,6,6,2,4,5,4,1,5,1,6,0,7,5,5,4,7,3,7,
	4,3,5,0,7,4,4,3,5,5,7,7,2,4,6,6,7,0,7,6,1,0,2,4,0,2,3,5,4,6,3,5,
	2,4,2,4,2,4,5,2,6,5,2,4,6,2,2,2,4,4,2,1,4,0,1,1,1,4,7,0,3,1,7,5,
	7,5,5,4,1,0,2,3,5,3,3,7,2,6,1,2,7,4,1,5,2,4,2,5,4,0,5,0,5,4,1,3,
	5,1,7,4,2,2,1,3,3,7,6,3,2,1,7,5,3,2,4,6,6,5,6,2,0,2,5,3,4,2,3,4,
	0,2,6,3,4,6,6,7,3,0,3,0,1,0,2,7,4,6,0,3,5,2,5,5,5,3,6,4,7,3,5,3,
	7,1,1,3,1,5,7,3,0,4,6,5,3,3,2,3,0,7,0,5,1,1,7,2,2,0,0,6,7,6,7,6,
	3,4,7,3,7,6,6,0,7,6,3,0,0,6,2,7,1,0,2,7,6,2,2,2,7,1,3,2,3,4,1,3,
	1,7,5,2,0,7,7,0,6,1,6,0,2,2,6,7,0,6,7,0,6,4,0,1,6,6,6,0,1,3,4,4,
	4,1,2,2,7,3,7,2,4,4,3,4,0,3,1,0,0,7,3,3,6,5,0,4,3,5,5,0,1,7,2,3,
	3,0,6,6,5,6,4,0,6,0,1,7,5,4,2,6,3,7,4,4,5,6,7,6,1,7,2,5,5,5,1,4,
	3,0,6,3,2,3,0,2,0,0,0,1,0,6,3,7,7,4,3,2,3,4,6,4,2,0,5,3,3,6,4,3,
	5,1,4,0,0,1,0,5,2,1,6,3,3,1,1,6,2,0,3,0,7,0,2,0,5,3,6,6,0,6,2,4,
	0,3,0,1,2,1,6,4,5,2,3,4,1,2,0,6,7,0,5,5,0,0,3,7,1,4,1,2,7,3,4,7,
	4,4,5,5,7,0,4,2,0,7,4,4,7,2,7,2,1,7,4,5,5,7,7,4,0,5,2,2,7,0,5,3,
	3,2,0,5,2,1,1,7,0,5,4,3,1,3,2,5,3,4,5,3,4,6,2,2,2,5,4,2,1,3,1,4,
	7,5,5,7,3,2,0,4,6,0,4,1,6,5,6,1,3,0,1,1,0,4,5,1,5,0,2,3,7,2,5,6,
	0,6,4,2,6,1,5,6,3,3,5,0,3,2,0,0,1,2,1,0,2,7,5,1,6,4,1,7,6,5,3,2,
	3,4,3,2,7,1,6,2,3,2,4,3,4,7,0,5,2,0,6,7,2,0,3,7,6,7,4,0,4,3,7,7,
	5,2,6,6,7,6,3,6,6,1,6,2,3,1,5,1,0,5,1,0,3,7,4,5,0,3,2,1,3,5,3,1,
	1,7,4,2,1,2,3,0,4,7,1,1,6,3,6,4,0,2,7,1,0,5,4,6,1,2,7,1,3,6,5,2,
	3,0,5,7,3,5,5,2,2,6,1,6,0,4,5,7,3,4,0,7,0,5,4,3,6,5,7,0,1,0,0,7,
	3,3,4,4,1,4,7,1,2,0,0,7,0,5,3,4,6,3,4,6,4,2,5,0,7,5,5,6,6,7,6,7,
	3,4,5,0,5,5,7,5,4,4,1,4,3,1,4,3,3,2,5,7,6,3,0,4,1,2,5,4,4,3,0,2,
	7,5,5,7,3,7,3,3,7,0,0,5,3,1,4,4,6,0,1,3,1,4,7,2,1,1,4,1,0,7,4,5,
	2,7,2,4,5,7,3,3,7,6,4,4,5,3,2,4,0,3,5,5,5,4,3,6,7,7,5,1,3,0,2,6,
	3,2,0,4,6,7,4,6,7,2,0,6,7,2,5,0,1,3,0,2,4,7,5,1,4,7,7,4,2,3,6,4,
	3,2,0,4,0,6,0,0,5,7,0,4,0,4,6,3,6,0,0,3,1,0,1,2,6,2,1,0,5,7,6,4,
	5,4,1,2,3,6,6,1,3,1,1,2,4,3,1,4,1,0,4,2,0,3,2,1,1,1,1,6,2,1,3,0,
	6,6,2,5,5,5,2,6,7,6,1,1,3,1,1,6,0,2,6,0,3,6,0,6,3,4,3,3,0,2,0,1,
	5,6,5,0,5,3,4,2,7,5,6,4,4,1,1,4,7,7,1,2,3,6,1,6,4,5,3,6,5,1,7,1,
	0,6,6,2,6,2,6,0,2,2,6,1,0,2,5,6,6,7,4,4,7,6,1,0,1,4,3,1,2,1,4,1,
	4,6,2,5,1,2,0,2,3,4,3,0,3,7,7,6,5,1,7,3,1,0,6,1,1,3,0,7,4,3,1,3,
	7,6,1,5,4,3,5,4,7,0,2,5,4,5,1,6,3,7,4,5,6,7,3,6,1,2,3,3,6,6,1,5,
	2,0,7,2,5,4,1,7,6,6,0,1,7,5,2,4,1,2,0,2,2,2,7,4,3,0,6,0,7,2,1,7,
	5,1,7,1,2,2,4,3,1,3,6,5,5,0,2,6,2,6,0,1,4,1,1,4,3,2,6,0,6,3,7,5,
	6,0,7,7,7,2,0,4,2,5,6,3,4,3,2,0,3,1,6,2,3,3,6,7,1,5,6,6,4,0,6,1,
	1,6,2,0,7,6,3,2,5,6,0,4,2,4,4,2,5,7,5,4,4,1,6,3,4,6,5,5,6,0,0,4,
	4,7,2,2,1,3,4,4,1,7,0,2,5,4,7,3,7,6,1,5,6,0,7,4,1,1,5,2,2,6,7,2);

//GFX
procedure deco56_decrypt_gfx(tag:pbyte;len:dword);
procedure deco74_decrypt_gfx(tag:pbyte;len:dword);
procedure deco56_remap_gfx(tag:pbyte;len:dword);
//CPU
procedure deco102_decrypt_cpu(datos,opcodes,data:pword;address_xor,data_select_xor,opcode_select_xor:word;size:dword);

implementation

procedure deco_decrypt(rgntag:pbyte;xor_table:pbyte;address_table:pword;swap_table:pbyte;len:dword;remap:boolean);
var
  rom,rom2,dec:word;
  i,addr,pat:dword;
  ptemp2,buffer:pbyte;
begin
  ptemp2:=rgntag;
  getmem(buffer,len);
  copymemory(buffer,rgntag,len);
	len:=len div 2;
	for i:=0 to len-1 do begin
		addr:=(i and not($7ff)) or (pwordarray(address_table)^[i and $7ff]);
		pat:=pbytearray(swap_table)^[i and $7ff];
    rom2:=pwordarray(buffer)^[addr];
    rom:=(rom2 shr 8) or ((rom2 and $ff) shl 8);
    if not(remap) then dec:=rom
    else
    dec:=BITSWAP16(rom xor xor_masks[pbytearray(xor_table)^[addr and $7ff]],
						swap_patterns[pat][0],
						swap_patterns[pat][1],
						swap_patterns[pat][2],
						swap_patterns[pat][3],
						swap_patterns[pat][4],
						swap_patterns[pat][5],
						swap_patterns[pat][6],
						swap_patterns[pat][7],
						swap_patterns[pat][8],
						swap_patterns[pat][9],
						swap_patterns[pat][10],
						swap_patterns[pat][11],
						swap_patterns[pat][12],
						swap_patterns[pat][13],
						swap_patterns[pat][14],
						swap_patterns[pat][15]);
    pwordarray(ptemp2)^[0]:=(dec shr 8) or ((dec and $ff) shl 8);
    inc(ptemp2,2);
	end;
  freemem(buffer);
end;

procedure deco56_decrypt_gfx(tag:pbyte;len:dword);
begin
	deco_decrypt(tag,@deco56_xor_table[0],@deco56_address_table[0],@deco56_swap_table[0],len,true);
end;

procedure deco56_remap_gfx(tag:pbyte;len:dword);
begin
	deco_decrypt(tag,@deco56_xor_table[0],@deco56_address_table[0],@deco56_swap_table[0],len,false);
end;

procedure deco74_decrypt_gfx(tag:pbyte;len:dword);
begin
  deco_decrypt(tag,@deco74_xor_table[0],@deco74_address_table[0],@deco74_swap_table[0],len,true);
end;

function decrypt_cpu102(data:word;address:dword;select_xor:dword):word;
var
  j:dword;
  bs:array[0..15] of byte;
  xorval:word;
begin
	// calculate bitswap to use
	j:=((address xor select_xor) and $f0) shr 4;
	if (address and $20000)<>0 then j:=j xor 4;
	copymemory(@bs[0],@cpu102_bitswaps[j,0],$10);

	// calculate xor to use
	j:=(address xor select_xor) and $0f;
	if (address and $40000)<>0 then j:=j xor 2;	// boogwing
	xorval:=cpu102_xors[j];

	// decrypt
	decrypt_cpu102:=xorval xor BITSWAP16(data,
				bs[0],bs[1],bs[2],bs[3],bs[4],bs[5],bs[6],bs[7],
				bs[8],bs[9],bs[10],bs[11],bs[12],bs[13],bs[14],bs[15]);
end;

procedure deco102_decrypt_cpu(datos,opcodes,data:pword;address_xor,data_select_xor,opcode_select_xor:word;size:dword);
var
  i,src:dword;
  temp_opcode,temp_data,temp_datos:pword;
begin
  temp_opcode:=opcodes;
  temp_data:=data;
	for i:=0 to (size shr 1)-1 do begin
		// calculate address of encrypted word in ROM
		src:=i and $f0000;
		if (i and $0001)<>0 then src:=src xor $be0b;
		if (i and $0002)<>0 then src:=src xor $5699;
		if (i and $0004)<>0 then src:=src xor $1322;
		if (i and $0008)<>0 then src:=src xor $0004;
		if (i and $0010)<>0 then src:=src xor $08a0;
		if (i and $0020)<>0 then src:=src xor $0089;
		if (i and $0040)<>0 then src:=src xor $0408;
		if (i and $0080)<>0 then src:=src xor $1212;
		if (i and $0100)<>0 then src:=src xor $08e0;
		if (i and $0200)<>0 then src:=src xor $5499;
		if (i and $0400)<>0 then src:=src xor $9a8b;
		if (i and $0800)<>0 then src:=src xor $1222;
		if (i and $1000)<>0 then src:=src xor $1200;
		if (i and $2000)<>0 then src:=src xor $0008;
		if (i and $4000)<>0 then src:=src xor $1210;
		if (i and $8000)<>0 then src:=src xor $00e0;
		src:=src xor address_xor;
    temp_datos:=datos;
    inc(temp_datos,src);
    //data
		temp_data^:=decrypt_cpu102(temp_datos^,i,data_select_xor);
    inc(temp_data);
    //opcode
		temp_opcode^:=decrypt_cpu102(temp_datos^,i,opcode_select_xor);
    inc(temp_opcode);
  end;
end;

end.
